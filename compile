#! /bin/bash

if test $1 -lt 40
then {
    OPTIONS="install --without-mpi --prefix=`pwd`/../boost"
}
else {
    OPTIONS="install --layout=versioned --without-mpi --prefix=`pwd`/../boost"
}
fi

if test -e /proc/
then {
    export CPUCOUNT=`grep -c ^processor /proc/cpuinfo`
    time ./bjam -j$CPUCOUNT toolset=gcc debug link=shared $OPTIONS \
        && time ./bjam -j$CPUCOUNT toolset=gcc release link=shared $OPTIONS
    [ `which clang++` ] && test $1 -gt 40 \
        && time ./bjam -j$CPUCOUNT toolset=clang debug link=shared $OPTIONS \
        && time ./bjam -j$CPUCOUNT toolset=clang release link=shared $OPTIONS
}
else {
    export CPUCOUNT=`sysctl -n hw.ncpu`
    time ./bjam -j$CPUCOUNT toolset=darwin architecture=x86 address-model=32_64 pch=off debug release $OPTIONS
}
fi
